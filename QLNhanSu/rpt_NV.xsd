<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="rpt_NV" targetNamespace="http://tempuri.org/rpt_NV.xsd" xmlns:mstns="http://tempuri.org/rpt_NV.xsd" xmlns="http://tempuri.org/rpt_NV.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="Settings" AppSettingsPropertyName="QLNSConnectionString1" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="QLNSConnectionString1 (Settings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.QLNhanSu.Properties.Settings.GlobalReference.Default.QLNSConnectionString1" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="Report_NhanVienTableAdapter" GeneratorDataComponentClassName="Report_NhanVienTableAdapter" Name="Report_NhanVien" UserDataComponentName="Report_NhanVienTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        Report_NhanVien.*
FROM            Report_NhanVien</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="MaNV" DataSetColumn="MaNV" />
              <Mapping SourceColumn="HoLot" DataSetColumn="HoLot" />
              <Mapping SourceColumn="Ten" DataSetColumn="Ten" />
              <Mapping SourceColumn="GioiTinh" DataSetColumn="GioiTinh" />
              <Mapping SourceColumn="NgaySinh" DataSetColumn="NgaySinh" />
              <Mapping SourceColumn="TenBoPhan" DataSetColumn="TenBoPhan" />
              <Mapping SourceColumn="tenchucvu" DataSetColumn="tenchucvu" />
              <Mapping SourceColumn="sohd" DataSetColumn="sohd" />
              <Mapping SourceColumn="QueQuan" DataSetColumn="QueQuan" />
              <Mapping SourceColumn="SDT" DataSetColumn="SDT" />
              <Mapping SourceColumn="thoiviec" DataSetColumn="thoiviec" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_chuadongBH" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_chuadongBH" GeneratorSourceName="FillBy_chuadongBH" GetMethodModifier="Public" GetMethodName="GetDataBy_chuadongBH" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_chuadongBH" UserSourceName="FillBy_chuadongBH">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        nv.*
FROM            Report_NhanVien nv
where            tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec  
and(
 nv.manv not in (select manv from DMBaoHiem) or 
( (year(getdate()) &gt;(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv)) or 
  (year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
and (month(getdate()) &gt;(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) 
or(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
and (month(getdate()) =(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv)) 
and (day(getdate()) &gt;(select day(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) )
)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_conhieuluchd" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_conhieuluchd" GeneratorSourceName="FillBy_conhieuluchd" GetMethodModifier="Public" GetMethodName="GetDataBy_conhieuluchd" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_conhieuluchd" UserSourceName="FillBy_conhieuluchd">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        Report_NhanVien.*
FROM            Report_NhanVien, HopDong hd
where            tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec  
and ( GETDATE()&gt;ngayhd and GETDATE()&lt;ngayhh and Report_NhanVien.sohd=hd.sohd)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_conhieulucHD_chuadongBH" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_conhieulucHD_chuadongBH" GeneratorSourceName="FillBy_conhieulucHD_chuadongBH" GetMethodModifier="Public" GetMethodName="GetDataBy_conhieulucHD_chuadongBH" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_conhieulucHD_chuadongBH" UserSourceName="FillBy_conhieulucHD_chuadongBH">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        nv.*
FROM            Report_NhanVien nv, HopDong hd
where    tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec 
and ( GETDATE()&gt;ngayhd and GETDATE()&lt;ngayhh and nv.sohd=hd.sohd)
and(
 nv.manv not in (select manv from DMBaoHiem) or 
( (year(getdate()) &gt;(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv)) or 
  (year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
and (month(getdate()) &gt;(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) 
or(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
and (month(getdate()) =(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv)) 
and (day(getdate()) &gt;(select day(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) )
)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_conhieulucHD_dadongBH" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_conhieulucHD_dadongBH" GeneratorSourceName="FillBy_conhieulucHD_dadongBH" GetMethodModifier="Public" GetMethodName="GetDataBy_conhieulucHD_dadongBH" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_conhieulucHD_dadongBH" UserSourceName="FillBy_conhieulucHD_dadongBH">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        nv.*
FROM            Report_NhanVien nv,HopDong hd
where        tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec  and
  (( (year(getdate()) &lt;(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv)) or 
(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
 and (month(getdate()) &lt;(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) 
 or(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
 and (month(getdate()) =(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv)) 
and (day(getdate()) &lt;(select day(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) ))

and( nv.manv not in (select manv from HopDong) or ( GETDATE()&gt;ngayhd and GETDATE()&lt;ngayhh and nv.sohd=hd.sohd))</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_dadongBH" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_dadongBH" GeneratorSourceName="FillBy_dadongBH" GetMethodModifier="Public" GetMethodName="GetDataBy_dadongBH" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_dadongBH" UserSourceName="FillBy_dadongBH">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        nv.*
FROM            Report_NhanVien nv
where            tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec  
and
  (( (year(getdate()) &lt;(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv)) or 
(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
 and (month(getdate()) &lt;(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) 
 or(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
 and (month(getdate()) =(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv)) 
and (day(getdate()) &lt;(select day(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) ))</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_hetHD_chuadongBH" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_hetHD_chuadongBH" GeneratorSourceName="FillBy_hetHD_chuadongBH" GetMethodModifier="Public" GetMethodName="GetDataBy_hetHD_chuadongBH" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_hetHD_chuadongBH" UserSourceName="FillBy_hetHD_chuadongBH">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        nv.*
FROM            Report_NhanVien nv
where            tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec  
and GETDATE()&gt;= all (select MAX(ngayhh) from HopDong  where manv=nv.manv) or nv.manv not in (select manv from HopDong)

and(
 nv.manv not in (select manv from DMBaoHiem) or 
( (year(getdate()) &gt;(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv)) or 
  (year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
and (month(getdate()) &gt;(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) 
or(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
and (month(getdate()) =(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv)) 
and (day(getdate()) &gt;(select day(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) )
)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_hetHD_dadongBH" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_hetHD_dadongBH" GeneratorSourceName="FillBy_hetHD_dadongBH" GetMethodModifier="Public" GetMethodName="GetDataBy_hetHD_dadongBH" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_hetHD_dadongBH" UserSourceName="FillBy_hetHD_dadongBH">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        nv.*
FROM            Report_NhanVien nv
where            tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec  
and GETDATE()&gt;= all (select MAX(ngayhh) from HopDong  where manv=nv.manv) or nv.manv not in (select manv from HopDong)

and
  (( (year(getdate()) &lt;(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv)) or 
(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
 and (month(getdate()) &lt;(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) 
 or(year(getdate()) =(select year(MAX(ngaycap))+1 from DMBaoHiem where manv=nv.manv) 
 and (month(getdate()) =(select month(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv)) 
and (day(getdate()) &lt;(select day(MAX(ngaycap)) from DMBaoHiem where manv=nv.manv))) ))</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy_nhanviendahethd" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy_nhanviendahethd" GeneratorSourceName="FillBy_nhanviendahethd" GetMethodModifier="Public" GetMethodName="GetDataBy_nhanviendahethd" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy_nhanviendahethd" UserSourceName="FillBy_nhanviendahethd">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        Report_NhanVien.*
FROM            Report_NhanVien 
where            tenbophan like @tenbophan and tenchucvu like @tenchucvu and thoiviec like @thoiviec  
and GETDATE()&gt;= all (select MAX(ngayhh) from HopDong  where manv=Report_NhanVien.manv) or Report_NhanVien.manv not in (select manv from HopDong)
</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="thoiviec" ColumnName="thoiviec" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(1)" DbType="String" Direction="Input" ParameterName="@thoiviec" Precision="0" ProviderType="NVarChar" Scale="0" Size="1" SourceColumn="thoiviec" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="QLNSConnectionString1 (Settings)" DbObjectName="QLNS.dbo.Report_NhanVien" DbObjectType="View" FillMethodModifier="Public" FillMethodName="FillBy1" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataBy1" GeneratorSourceName="FillBy1" GetMethodModifier="Public" GetMethodName="GetDataBy1" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy1" UserSourceName="FillBy1">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        distinct Report_NhanVien.*
FROM            Report_NhanVien, HopDong hd
where  tenbophan like @tenbophan and tenchucvu like @tenchucvu
 and( Report_NhanVien.manv not in (select manv from HopDong) or ( GETDATE()&gt;ngayhd and GETDATE()&lt;ngayhh and Report_NhanVien.sohd=hd.sohd))</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="tenbophan" ColumnName="TenBoPhan" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenbophan" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="TenBoPhan" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="tenchucvu" ColumnName="tenchucvu" DataSourceName="QLNS.dbo.Report_NhanVien" DataTypeServer="nvarchar(50)" DbType="String" Direction="Input" ParameterName="@tenchucvu" Precision="0" ProviderType="NVarChar" Scale="0" Size="50" SourceColumn="tenchucvu" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="rpt_NV" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="rpt_NV" msprop:Generator_UserDSName="rpt_NV">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="Report_NhanVien" msprop:Generator_TableClassName="Report_NhanVienDataTable" msprop:Generator_TableVarName="tableReport_NhanVien" msprop:Generator_TablePropName="Report_NhanVien" msprop:Generator_RowDeletingName="Report_NhanVienRowDeleting" msprop:Generator_UserTableName="Report_NhanVien" msprop:Generator_RowChangingName="Report_NhanVienRowChanging" msprop:Generator_RowEvHandlerName="Report_NhanVienRowChangeEventHandler" msprop:Generator_RowDeletedName="Report_NhanVienRowDeleted" msprop:Generator_RowEvArgName="Report_NhanVienRowChangeEvent" msprop:Generator_RowChangedName="Report_NhanVienRowChanged" msprop:Generator_RowClassName="Report_NhanVienRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="MaNV" msprop:Generator_ColumnVarNameInTable="columnMaNV" msprop:Generator_ColumnPropNameInRow="MaNV" msprop:Generator_ColumnPropNameInTable="MaNVColumn" msprop:Generator_UserColumnName="MaNV">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="HoLot" msprop:Generator_ColumnVarNameInTable="columnHoLot" msprop:Generator_ColumnPropNameInRow="HoLot" msprop:Generator_ColumnPropNameInTable="HoLotColumn" msprop:Generator_UserColumnName="HoLot">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="30" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="Ten" msprop:Generator_ColumnVarNameInTable="columnTen" msprop:Generator_ColumnPropNameInRow="Ten" msprop:Generator_ColumnPropNameInTable="TenColumn" msprop:Generator_UserColumnName="Ten">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="GioiTinh" msprop:Generator_ColumnVarNameInTable="columnGioiTinh" msprop:Generator_ColumnPropNameInRow="GioiTinh" msprop:Generator_ColumnPropNameInTable="GioiTinhColumn" msprop:Generator_UserColumnName="GioiTinh" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="2" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NgaySinh" msprop:Generator_ColumnVarNameInTable="columnNgaySinh" msprop:Generator_ColumnPropNameInRow="NgaySinh" msprop:Generator_ColumnPropNameInTable="NgaySinhColumn" msprop:Generator_UserColumnName="NgaySinh" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TenBoPhan" msprop:Generator_ColumnVarNameInTable="columnTenBoPhan" msprop:Generator_ColumnPropNameInRow="TenBoPhan" msprop:Generator_ColumnPropNameInTable="TenBoPhanColumn" msprop:Generator_UserColumnName="TenBoPhan" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="tenchucvu" msprop:Generator_ColumnVarNameInTable="columntenchucvu" msprop:Generator_ColumnPropNameInRow="tenchucvu" msprop:Generator_ColumnPropNameInTable="tenchucvuColumn" msprop:Generator_UserColumnName="tenchucvu" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="50" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="sohd" msprop:Generator_ColumnVarNameInTable="columnsohd" msprop:Generator_ColumnPropNameInRow="sohd" msprop:Generator_ColumnPropNameInTable="sohdColumn" msprop:Generator_UserColumnName="sohd" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="10" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="QueQuan" msprop:Generator_ColumnVarNameInTable="columnQueQuan" msprop:Generator_ColumnPropNameInRow="QueQuan" msprop:Generator_ColumnPropNameInTable="QueQuanColumn" msprop:Generator_UserColumnName="QueQuan" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="70" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SDT" msprop:Generator_ColumnVarNameInTable="columnSDT" msprop:Generator_ColumnPropNameInRow="SDT" msprop:Generator_ColumnPropNameInTable="SDTColumn" msprop:Generator_UserColumnName="SDT" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="11" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="thoiviec" msprop:Generator_ColumnVarNameInTable="columnthoiviec" msprop:Generator_ColumnPropNameInRow="thoiviec" msprop:Generator_ColumnPropNameInTable="thoiviecColumn" msprop:Generator_UserColumnName="thoiviec" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="1" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
    <xs:unique name="Constraint1" msdata:PrimaryKey="true">
      <xs:selector xpath=".//mstns:Report_NhanVien" />
      <xs:field xpath="mstns:MaNV" />
    </xs:unique>
  </xs:element>
</xs:schema>